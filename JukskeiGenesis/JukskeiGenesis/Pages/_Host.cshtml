@page "/"
@namespace JukskeiGenesis.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";
}

<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<component type="typeof(App)" render-mode="ServerPrerendered" />

<script>
    function onClickButton() {
        var acc = document.getElementsByClassName("AccordionButton");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var panel = this.nextElementSibling;

                console.log("Check check");

                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                    panel.style.borderLeftWidth = "0px";
                    panel.style.borderRightWidth = "0px";
                    panel.style.borderBottomWidth = "0px";
                    panel.style.transition = "background-Top-color 0.5s ease";
                    panel.style.borderTopColor = "transparent";
                    panel.style.borderColor = "transparent";
                    panel.style.border = "colaps";
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                    panel.style.borderLeftWidth = "1px";
                    panel.style.borderRightWidth = "1px";
                    panel.style.borderBottomWidth = "1px";
                    panel.style.border = "solid 1px lightgrey";
                }
            });
        }
    }

    function setupAccordion() {
        var acc = document.getElementsByClassName("AccordionButton");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function () {
                toggleAccordion(this);
            });
        }
    }

    function toggleAccordion(accordionElement) {
        accordionElement.classList.toggle("active");
        var panel = accordionElement.nextElementSibling;

        console.log("Check check");

        if (panel.style.maxHeight) {
            panel.style.maxHeight = null;
            panel.style.borderLeftWidth = "0px";
            panel.style.borderRightWidth = "0px";
            panel.style.borderBottomWidth = "0px";
            panel.style.transition = "background-Top-color 0.5s ease";
            panel.style.borderTopColor = "transparent";
            panel.style.borderColor = "transparent";
            panel.style.border = "colaps";
        } else {
            panel.style.maxHeight = panel.scrollHeight + "px";
            panel.style.borderLeftWidth = "1px";
            panel.style.borderRightWidth = "1px";
            panel.style.borderBottomWidth = "1px";
            panel.style.border = "solid 1px lightgrey";
        }
    }

    function AddTeamsToCategories() {
        var categoryNameTrue = document.getElementById("TeamCategories").value;
        var teamName = document.getElementById("TeamName").value;

        var playersNameArr = GetPlayerNames();

        if(playersNameArr.length <= 3)
            return "Please add at least 4 players";

        if (categoryNameTrue == "EmptyOption" && categoryNameTrue == null && categoryNameTrue == "")
            return "Please select a Category for the team.";
        else if (teamName == "" && teamName == null && teamName == "")
            return "Please enter a team name.";

        var categoryTable = document.getElementById(`Table_${categoryNameTrue}`);

        var newRow = categoryTable.insertRow(-1);

        var cell = newRow.insertCell(0);

        let cellContent = `${teamName}\n`;        

        for (let i = 0; i < playersNameArr.length; i++) {
            if (playersNameArr.length - 1 != i)
                cellContent += `${playersNameArr[i]}, `;
            else
                cellContent += `${playersNameArr[i]}`;
        }

        cell.textContent = cellContent;
        cell.style.borderBottom = "1px solid black";
        cell.style.borderTop = "1px solid black";
        cell.style.textAlign = "center";
        cell.classList.add("TableContent");
    }

    function GetPlayerNames() {
        var inputElements = document.querySelectorAll('.PleyerNames .InputLabels');
        var playerNames = Array.from(inputElements).map(function (inputElement) {
            return inputElement.value;
        }).filter(function (playerName) {
            return playerName.trim() !== '';
        });

        return playerNames;
    }


</script>